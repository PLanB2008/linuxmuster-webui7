<br/>

<progress-spinner ng:show="settings == null"></progress-spinner>

<div ng:show="settings != null">
    <uib:tabset active=activetab>

    <uib:tab heading="{{'General'|translate}}">
    <br/>

    <h3 translate>General</h3>
    <table class="lm-table lm-table-padded">
        <tr>
            <td width=25%>
                <label translate>Schoolname</label>
            </td>
            <td>
                <input type="text" class="form-control" ng:model="settings.school.SCHOOL_LONGNAME" />
            </td>
        </tr>
    </table>

    <h3 translate>Email Domain</h3>
    <table class="lm-table lm-table-padded">
        <tr>
            <td width=25%>
                <label translate>Role Students</label>
            </td>
            <td>
                <input type="text" class="form-control" placeholder="{{'e.g.: linuxmuster.net'|translate}}" ng:model="settings['role.student']['MAILDOMAIN']" />
            </td>
        </tr>
        <tr>
            <td>
                <label translate>Role Teachers</label>
            </td>
            <td>
                <input type="text" class="form-control" placeholder="{{'e.g.: linuxmuster.net'|translate}}" ng:model="settings['role.teacher']['MAILDOMAIN']" />
            </td>
        </tr>
        <tr>
            <td>
                <label translate>Primary Group Adminclass</label>
            </td>
            <td>
                <input type="text" class="form-control" placeholder="{{'e.g.: linuxmuster.net'|translate}}" ng:model="settings['type.adminclass']['MAILDOMAIN']" />
            </td>
        </tr>
        <tr>
            <td>
                <label translate>Primary Group Teacherclass</label>
            </td>
            <td>
                <input type="text" class="form-control" placeholder="{{'e.g.: linuxmuster.net'|translate}}" ng:model="settings['type.teacherclass']['MAILDOMAIN']" />
            </td>
        </tr>
    </table>
    <h3 translate>Printserver </h3>
    <table class="lm-table lm-table-padded">
        <tr>
            <td width=25%>
                <label translate>Printserver</label>
            </td>
            <td>
                <input type="text" class="form-control" placeholder="{{'default: server'|translate}}" ng:model="settings.school.PRINTSERVER" />
            </td>
        </tr>
    </table>

    </uib:tab>

    <uib:tab heading="{{'Listimport'|translate}}">
    <br/>
    <h3 translate>Username and Passwords</h3>
    <table class="lm-table lm-table-padded">
        <tr>
            <th width="40%"></th>
            <th translate>Students</th>
            <th translate>Teachers</th>
            <th translate>extrastudents</th>
        </tr>
        <tr>
            <td>
                <label translate>Reverse Surname and Firstname in username</label>
            </td>
            <td>
                <span checkbox ng:model="settings['userfile.students.csv']['surname_firstname_reverse']" />
            </td>
            <td>
                <span checkbox ng:model="settings['userfile.teachers.csv']['surname_firstname_reverse']" />
            </td>
            <td>
                <span checkbox ng:model="settings['userfile.extrastudents.csv']['surname_firstname_reverse']" />
            </td>
        </tr>
        <tr>
            <td>
                <label translate>Surname Characters</label>
            </td>
            <td>
                <input type="number" class="form-control" ng:model="settings['userfile.students.csv']['SURNAME_CHARS']" />
            </td>
            <td>
                <input type="number" class="form-control" ng:model="settings['userfile.teachers.csv']['SURNAME_CHARS']" />
            </td>
            <td>
                <input type="number" class="form-control" ng:model="settings['userfile.extrastudents.csv']['SURNAME_CHARS']" />
            </td>
        </tr>
        <tr>
            <td>
                <label translate>Firstname Chars</label>
            </td>
            <td>
                <input type="number" class="form-control" ng:model="settings['userfile.students.csv']['FIRSTNAME_CHARS']" />
            </td>
            <td>
                <input type="number" class="form-control" ng:model="settings['userfile.teachers.csv']['FIRSTNAME_CHARS']" />
            </td>
            <td>
                <input type="number" class="form-control" ng:model="settings['userfile.extrastudents.csv']['FIRSTNAME_CHARS']" />
            </td>
        </tr>
        <tr>
            <td>
                <label translate>Password Length</label>
            </td>
            <td>
                <input type="number" class="form-control" ng:model="settings['userfile.students.csv']['PWD_LENGTH']" />
            </td>
            <td>
                <input type="number" class="form-control" ng:model="settings['userfile.teachers.csv']['PWD_LENGTH']" />
            </td>
            <td>
                <input type="number" class="form-control" ng:model="settings['userfile.extrastudents.csv']['PWD_LENGTH']" />
            </td>
        </tr>
        <tr ng:show="settings.lehrer_zufall_passwort || settings.schueler_zufall_passwort" >
            <td>
                <label translate>Password length</label>
            </td>
            <td>
                <input type="number" class="form-control" ng:model="settings['userfile.students.csv']['PWD_LENGTH']"  />
            </td>
            <td>
                <input type="number" class="form-control" ng:model="settings['userfile.teachers.csv']['PWD_LENGTH']" ng:show="settings.schueler_zufall_passwort" />
            </td>
            <td>
                <input type="number" class="form-control" ng:model="settings['userfile.extrastudents.csv']['PWD_LENGTH']" ng:show="settings.schueler_zufall_passwort" />
            </td>
        </tr>
        <tr>
            <td>
                <label translate>Random password</label>
            </td>
            <td>
                <span checkbox ng:model="settings['userfile.students.csv']['RANDOM_PWD']" />
            </td>
            <td>
                <span checkbox ng:model="settings['userfile.teachers.csv']['RANDOM_PWD']" />
            </td>
            <td>
                <span checkbox ng:model="settings['userfile.extrastudents.csv']['RANDOM_PWD']" />
            </td>

        </tr>
        <tr>
            <td>
                <label translate>Tolerance after departure (days)</label>
            </td>
            <td>
                <input type="number" class="form-control" ng:model="settings['userfile.students.csv']['TOLERATION_TIME']" />
            </td>
            <td>
                <input type="number" class="form-control" ng:model="settings['userfile.teachers.csv']['TOLERATION_TIME']">
            </td>
            <td>
                <input type="number" class="form-control" ng:model="settings['userfile.extrastudents.csv']['TOLERATION_TIME']">
            </td>
        </tr>
        <tr>
            <td>
                <label translate>Removal after departure (days)</label>
            </td>
            <td>
                <input type="number" class="form-control" ng:model="settings['userfile.students.csv']['DEACTIVATION_TIME']" />
            </td>
            <td>
                <input type="number" class="form-control" ng:model="settings['userfile.teachers.csv']['DEACTIVATION_TIME']" />
            </td>
            <td>
                <input type="number" class="form-control" ng:model="settings['userfile.extrastudents.csv']['DEACTIVATION_TIME']" />
            </td>
        </tr>
        <tr>
            <td>
                <label translate>Replace slash(/) in classname by hypen(-)</label>
            </td>
            <td>
                <span checkbox ng:model="settings['userfile.students.csv']['CLASSNAME_SLASH_TO_HYPHEN']" />
            </td>
            <td>
            </td>
            <td>
            </td>
        </tr>
    </table>
    <h3 translate>Encoding</h3>
    <table class="lm-table lm-table-padded">
        <tr>
            <th width="40%"></th>
            <th translate>students.csv encoding</th>
            <th translate>teachers.csv encoding</th>
            <th translate>extrastudents.csv encoding</th>
            <!--<th translate>extraclasses.csv encoding</th>-->
        </tr>
        <tr>
            <td>
                <label translate>List encoding</label>
            </td>
            <td>
                <select class="form-control" ng:model="settings['userfile.students.csv']['ENCODING']" ng:options="x for x in encodings" />
                    <div ng:show="settings['userfile.students.csv']['ENCODING'] == 'auto'" >
            </td>
            <td>
                <select class="form-control" ng:model="settings['userfile.teachers.csv']['ENCODING']" ng:options="x for x in encodings" />
                    <div ng:show="settings['userfile.teachers.csv']['ENCODING'] == 'auto'" >
            </td>
            <td>
                <select class="form-control" ng:model="settings['userfile.extrastudents.csv']['ENCODING']" ng:options="x for x in encodings" />
                    <div ng:show="settings['userfile.extrastudents.csv']['ENCODING'] == 'auto'" >
            </td>
            <!--<td>
                <select class="form-control" ng:model="settings['userfile.extraclasses.csv']['encoding']" ng:options="x for x in encodings" />
                    <div ng:show="settings['userfile.extraclasses.csv']['encoding'] == 'auto'" >
            </td>-->
        </tr>
        <tr>
            <td>
                <label translate>Detected encoding</label>
            </td>
            <td>
                {{encoding['userfile.students.csv']}}
            </td>
            <td>
                {{encoding['userfile.teachers.csv']}}
            </td>
            <td>
                {{encoding['userfile.extrastudents.csv']}}
            </td>
            <!--<td>
                {{encoding['userfile.extraclasses.csv']}}
            </td>-->
        </tr>
    </table>

    </uib:tab>


    </uib:tab>
    <uib:tab heading="{{'Quota'|translate}}">
    <br/>
    <h3 translate>Quota </h3>
    <table class="lm-table lm-table-padded">
        <tr>
            <th width="40%"></th>
            <th translate>Students</th>
            <th translate>Teachers</th>
            <th translate>Schooladministrator</th>
        </tr>
        <tr>
            <td>
                <label translate>Quota Default Global in MiB</label>
            </td>
            <td>
                <input type="number" class="form-control" ng:model="settings['role.student']['QUOTA_DEFAULT_GLOBAL']" />
            </td>
            <td>
                <input type="number" class="form-control" ng:model="settings['role.teacher']['QUOTA_DEFAULT_GLOBAL']" />
            </td>
            <td>
                <input type="number" class="form-control" ng:model="settings['role.schooladministrator']['QUOTA_DEFAULT_GLOBAL']" />
            </td>
        </tr>
        <tr>
            <td>
                <label translate>Quota Default School in MiB</label>
            </td>
            <td>
                <input type="number" class="form-control" ng:model="settings['role.student']['QUOTA_DEFAULT_SCHOOL']" />
            </td>
            <td>
                <input type="number" class="form-control" ng:model="settings['role.teacher']['QUOTA_DEFAULT_SCHOOL']" />
            </td>
            <td>
                <input type="number" class="form-control" ng:model="settings['role.schooladministrator']['QUOTA_DEFAULT_SCHOOL']" />
            </td>
        </tr>
        <tr>
            <td>
                <label translate>Cloudquota Percentage</label>
            </td>
            <td>
                <input type="number" class="form-control" ng:model="settings['role.student']['CLOUDQUOTA_PERCENTAGE']" />
            </td>
            <td>
                <input type="number" class="form-control" ng:model="settings['role.teacher']['CLOUDQUOTA_PERCENTAGE']" />
            </td>
            <td>
                <input type="number" class="form-control" ng:model="settings['role.schooladministrator']['CLOUDQUOTA_PERCENTAGE']" />
            </td>
        </tr>
        <tr>
            <td>
                <label translate>Mailquota Default in MiB</label>
            </td>
            <td>
                <input type="number" class="form-control" ng:model="settings['role.student']['MAILQUOTA_DEFAULT']" />
            </td>
            <td>
                <input type="number" class="form-control" ng:model="settings['role.teacher']['MAILQUOTA_DEFAULT']" />
            </td>
            <td>
                <input type="number" class="form-control" ng:model="settings['role.schooladministrator']['MAILQUOTA_DEFAULT']" />
            </td>
        </tr>
    </table>



    </uib:tab>
    <uib:tab heading="{{'Printing data'|translate}}">
    <h2 translate>Password printing data</h2>
    <br/>

    <table class="lm-table lm-table-padded">
        <tr>
            <td width=25%>
                <label translate>School name</label>
            </td>
            <td>
                <input type="text" class="form-control" ng:model="settings.school.SCHOOL_LONGNAME" disabled />
            </td>
        </tr>
        <tr>
            <td>
                <label translate>Internal FQDN for printing</label>
            <td>
                <input type="text" class="form-control" ng:model="settings.server_fqdn_internal_print" disabled />
            </td>
        </tr>
        <tr>
            <td>
                <label translate>External FQDN for printing</label>
            </td>
            <td>
                <input type="text" class="form-control" ng:model="settings.server_fqdn_external_print" disabled />
            </td>
        </tr>
        <tr>
            <td>
                <label translate>Samba domain for printing</label>
            </td>
            <td>
                <input type="text" class="form-control" ng:model="settings.smb_domain_print" disabled />
            </td>
        </tr>
        <tr>
            <td>
                <label translate>MOODLE URL</label>
            </td>
            <td>
                <input type="text" class="form-control" ng:model="settings.moodle_url" disabled />
            </td>
        </tr>
        <tr>
            <td>
                <label translate>Admin e-mail</label>
            </td>
            <td>
                <input type="text" class="form-control" ng:model="settings.admins_print" disabled />
            </td>
        </tr>
    </table>

    </uib:tab>
    <!--
    <uib:tab heading="{{'Subnets'|translate}}">
        <h2 translate>List of subnets</h2>
        <div class="alert alert-danger" translate>
            <i class="fa fa-warning "></i>
            Change this values with high precaution ! A wrong value may completely block your network !
        </div>
        <table class="table">
            <tr>
                <th translate>Network / Prefix</th>
                <th translate>Ip router</th>
                <th translate>Begin lease range</th>
                <th translate>End lease range</th>
                <th translate>Setup flag</th>
            </tr>
            <tr ng:repeat="subnet in subnets" ng:if="subnet.network.charAt(0) != '#'">
                <td>
                    <input type="text" ng:model-options="{updateOn: 'blur'}" ng:model="subnet.network" placeholder="Network" class="form-control" />
                </td>
                <td>
                    <input type="text" ng:model-options="{updateOn: 'blur'}" ng:model="subnet.routerIp" placeholder="Ip router" class="form-control" />
                </td>
                <td>
                    <input type="text" ng:model-options="{updateOn: 'blur'}" ng:model="subnet.beginRange" placeholder="Begin lease range" class="form-control" />
                </td>
                <td>
                    <input type="text" ng:model-options="{updateOn: 'blur'}" ng:model="subnet.endRange" placeholder="End lease range" class="form-control" />
                </td>
                <td>
                    <input type="text" ng:model-options="{updateOn: 'blur'}" ng:model="subnet.setupFlag" placeholder="Setup flag" class="form-control" />
                </td>
                <td width="1">
                    <button class="btn btn-default" ng:click="removeSubnet(subnet)" title={{trans.remove}}>
                        <i class="fa fa-trash-o"></i>
                    </button>
                </td>
            </tr>
        </table>

        <button class="btn btn-default" ng:click="addSubnet()">
            <i class="fa fa-plus"></i> <span translate>Add a subnet</span>
        </button>
    </uib:tab>
    -->
    </uib:tabset>

    <div class="floating-toolbar-padder"></div>
    <floating-toolbar>
        <button ng:click="backups()" class="btn btn-default btn-flat pull-right"><i class="fa fa-history"></i></button>
        <button ng-show="activetab <= 3" ng:click="save()" class="btn btn-default btn-flat" translate>Save</button>
        <button ng-show="activetab == 0" ng:click="saveAndCheck()" class="btn btn-default btn-flat" translate>Save &amp; check</button>
        <button ng-show="activetab == 2" ng:click="saveApplyQuota()" class="btn btn-default btn-flat" translate>Save &amp; Apply Quota</button>
        <button ng-show="activetab == 4" ng:click="saveApplySubnets()" class="btn btn-default btn-flat" translate>Save &amp; Apply Subnets</button>
    </floating-toolbar>
</div>
