<br/>

<progress-spinner ng:show="settings == null"></progress-spinner>

<div ng:show="settings != null">
    <uib:tabset>
        <uib:tab heading="{{'Teachers'|translate}}">
            <br/>
            <table class="lm-table lm-table-padded">
                <tr>
                    <th translate>Name</th>
                    <th ng:repeat="qt in quota_types">{{qt.name}}</th>
                </tr>
                <tr style="font-weight:bold;">
                    <td translate>
                        Default value in school.conf
                    </td>
                    <td ng:repeat="qt in quota_types">
                        <input type="number" ng:model="settings['role.teacher'][qt.type]" class="form-control" />
                    </td>
                </tr>
                <tr ng:repeat="(login,details) in non_default.teacher">
                    <td>
                        {{details.displayName}}
                    </td>
                    <td ng:repeat="qt in quota_types">
                        <input type="number" ng:model="details.QUOTA[qt.type]" class="form-control"  ng:class="{'nondefault': defaultTest('role.teacher', qt.type, details.QUOTA[qt.type])}" ng:disabled="qt.type == 'cloudquota_percentage'" />
                    </td>
                </tr>
            </table>
            <hr />
            <h4 translate>Add special quota</h4>
            <input type="text" placeholder="{{searchText}}" ng:model="_.addNewSpecial" typeahead-editable="false" typeahead-min-length="3" uib-typeahead="user as user.label for user in findUsers($viewValue, 'teacher') | limitTo:8" class="form-control" />
        </uib:tab>
        <uib:tab heading="{{'Students'|translate}}">
            <br/>
            <table class="lm-table lm-table-padded">
                <tr>
                    <th translate>Name (login)</th>
                    <th ng:repeat="qt in quota_types">{{qt.name}}</th>
                </tr>
                <tr style="font-weight:bold;">
                    <td translate>
                        Default value in school.conf
                    </td>
                    <td ng:repeat="qt in quota_types">
                        <input type="number" ng:model="settings['role.student'][qt.type]" class="form-control" />
                    </td>
                </tr>
                <tr ng:repeat="(login,details) in non_default.student">
                    <td>{{details.displayName}} ({{login}})</td>
                    <td ng:repeat="qt in quota_types">
                        <input type="number" ng:model="details.QUOTA[qt.type]" class="form-control"  ng:class="{'nondefault': defaultTest('role.student', qt.type, details.QUOTA[qt.type])}" ng:disabled="qt.type == 'cloudquota_percentage'" />
                    </td>
                </tr>
            </table>
            <hr />
            <h4 translate>Add special quota</h4>
            <input type="text" placeholder="{{searchText}}" ng:model="_.addNewSpecial" typeahead-editable="false" typeahead-min-length="3" uib-typeahead="user as user.label for user in findUsers($viewValue, 'student') | limitTo:8" class="form-control" />
        </uib:tab>
        <uib:tab heading="{{'Admins'|translate}}">
            <br/>
            <table class="lm-table lm-table-padded">
                <tr>
                    <th translate>Name</th>
                    <th ng:repeat="qt in quota_types">{{qt.name}}</th>
                </tr>
                <tr style="font-weight:bold;">
                    <td translate>
                        Default value in school.conf
                    </td>
                    <td ng:repeat="qt in quota_types">
                        <input type="number" ng:model="settings['role.schooladministrator'][qt.type]" class="form-control" />
                    </td>
                </tr>
                <tr ng:repeat="(login,details) in non_default.schooladministrator">
                    <td>
                        {{details.displayName}}
                    </td>
                    <td ng:repeat="qt in quota_types">
                        <input type="number" ng:model="details.QUOTA[qt.type]" class="form-control"  ng:class="{'nondefault': defaultTest('role.schooladministrator', qt.type, details.QUOTA[qt.type])}" ng:disabled="qt.type == 'cloudquota_percentage'" />
                    </td>
                </tr>
            </table>
            <hr />
            <h4 translate>Add special quota</h4>
            <input type="text" placeholder="{{searchText}}" ng:model="_.addNewSpecial" typeahead-editable="false" typeahead-min-length="3" uib-typeahead="user as user.label for user in findUsers($viewValue, 'teacher') | limitTo:8" class="form-control" />
        </uib:tab>
        <uib:tab heading="{{'Classes'|translate}}">
            <br/>
            <table class="lm-table lm-table-padded">
                <tr>
                    <th translate>Name</th>
                    <th>Default</th>
                    <th translate>Mail</th>
                </tr>
                <tr ng:repeat="class in classes">
                    <td>
                        {{class.name}}
                    </td>
                    <td>
                        <input type="number" ng:model="class.quota" class="form-control" />
                    </td>
                    <td>
                        <input type="number" ng:model="class.mailquota" class="form-control" />
                    </td>
                </tr>
            </table>
        </uib:tab>
        <uib:tab heading="{{'Projects'|translate}}">
            <br/>
            <table class="lm-table lm-table-padded">
                <tr>
                    <th translate>Name</th>
                    <th>Default</th>
                    <th>Mail</th>
                </tr>
                <tr ng:repeat="project in projects">
                    <td>
                        {{project.name}}
                    </td>
                    <td>
                        <input type="number" ng:model="project.quota" class="form-control" />
                    </td>
                    <td>
                        <input type="number" ng:model="project.mailquota" class="form-control" />
                    </td>
                </tr>
            </table>
        </uib:tab>
        <uib:tab heading="{{'Special'|translate}}">
            <br/>
            <table class="lm-table lm-table-padded">
                <tr>
                    <th translate>Name</th>
                    <th>/home</th>
                    <th>/var</th>
                    <th translate>Mail</th>
                    <th></th>
                </tr>
                <tr ng:repeat="quota in specialQuotas">
                    <td>
                        {{quota.name}}
                    </td>
                    <td>
                        <input type="number" ng:model="quotas[quota.login].home" class="form-control" />
                    </td>
                    <td>
                        <input type="number" ng:model="quotas[quota.login].var" class="form-control" />
                    </td>
                    <td>
                        <input type="number" ng:model="quotas[quota.login].mail" class="form-control" />
                    </td>
                </tr>
            </table>
        </uib:tab>
    </uib:tabset>

    <div class="floating-toolbar-padder"></div>

    <floating-toolbar>
        <button ng:click="backups()" class="btn btn-default btn-flat pull-right"><i class="fa fa-history"></i></button>

        <button ng:click="save()" class="btn btn-default btn-flat" translate>Save</button>
        <button ng:click="saveApply()" class="btn btn-default btn-flat" translate>Save & apply</button>
    </floating-toolbar>
</div>
