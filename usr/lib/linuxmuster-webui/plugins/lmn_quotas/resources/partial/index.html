<br/>

<progress-spinner ng:show="settings == null"></progress-spinner>

<div ng:show="settings != null">
    <uib:tabset>
        <uib:tab heading="{{'Defaults'|translate}}">
            <br/>
            <table class="lm-table lm-table-padded">
                <tr>
                    <th width="40%"></th>
                    <th translate>Students</th>
                    <th translate>Teachers</th>
                    <th translate>Schooladministrator</th>
                </tr>
                <tr>
                    <td>
                        <label translate>Quota Default Global in MiB</label>
                    </td>
                    <td>
                        <input type="number" class="form-control" ng:model="settings['role.student']['quota_default_global']" />
                    </td>
                    <td>
                        <input type="number" class="form-control" ng:model="settings['role.teacher']['quota_default_global']" />
                    </td>
                    <td>
                        <input type="number" class="form-control" ng:model="settings['role.schooladministrator']['quota_default_global']" />
                    </td>
                </tr>
                <tr>
                    <td>
                        <label translate>Quota Default School in MiB</label>
                    </td>
                    <td>
                        <input type="number" class="form-control" ng:model="settings['role.student']['quota_default_school']" />
                    </td>
                    <td>
                        <input type="number" class="form-control" ng:model="settings['role.teacher']['quota_default_school']" />
                    </td>
                    <td>
                        <input type="number" class="form-control" ng:model="settings['role.schooladministrator']['quota_default_school']" />
                    </td>
                </tr>
                <tr>
                    <td>
                        <label translate>Cloudquota Percentage</label>
                    </td>
                    <td>
                        <input type="number" class="form-control" ng:model="settings['role.student']['cloudquota_percentage']" />
                    </td>
                    <td>
                        <input type="number" class="form-control" ng:model="settings['role.teacher']['cloudquota_percentage']" />
                    </td>
                    <td>
                        <input type="number" class="form-control" ng:model="settings['role.schooladministrator']['cloudquota_percentage']" />
                    </td>
                </tr>
                <tr>
                    <td>
                        <label translate>Mailquota Default in MiB</label>
                    </td>
                    <td>
                        <input type="number" class="form-control" ng:model="settings['role.student']['mailquota_default']" />
                    </td>
                    <td>
                        <input type="number" class="form-control" ng:model="settings['role.teacher']['mailquota_default']" />
                    </td>
                    <td>
                        <input type="number" class="form-control" ng:model="settings['role.schooladministrator']['mailquota_default']" />
                    </td>
                </tr>
            </table>
        </uib:tab>
        <uib:tab heading="{{'Teachers'|translate}}">
            <br/>
            <table class="lm-table lm-table-padded">
                <tr>
                    <th translate>Name</th>
                    <th>Default</th>
                    <th>Global</th>
                    <th>Cloud</th>
                    <th translate>Mail</th>
                </tr>
                <tr>
                    <td translate>
                        Default
                    </td>
                    <td>
                        <input type="number" ng:model="settings['role.teacher']['quota_default_global']" class="form-control" />
                    </td>
                    <td>
                        <input type="number" ng:model="settings['role.teacher']['quota_default_school']" class="form-control" />
                    </td>
                    <td>
                        <input type="number" ng:model="settings['role.teacher']['cloudquota_percentage']" class="form-control" />
                    </td>
                    <td>
                        <input type="number" ng:model="settings['role.teacher']['mailquota_default']" class="form-control" />
                    </td>
                </tr>
                <tr ng:repeat="(login,details) in non_default.teacher">
                    <td>
                        {{details.displayName}}
                    </td>
                    <td>
                        <input type="number" ng:model="details.QUOTA['linuxmuster-global'].VALUE" class="form-control" />
                    </td>
                    <td>
                        <input type="number" ng:model="details.QUOTA['default-school'].VALUE" class="form-control" />
                    </td>
                    <td>
                        <input type="number" ng:model="details.QUOTA.CQ.VALUE" class="form-control" />
                    </td>
                    <td>
                        <input type="number" ng:model="details.QUOTA.MQ.VALUE" class="form-control" />
                    </td>
                </tr>
            </table>
            <h4 translate>Add special quota</h4>
            <input type="text" placeholder="TEST" ng:model="_.addNewSpecial" typeahead-editable="false" typeahead-min-length="3" uib-typeahead="user for user in findUsers($viewValue) | limitTo:8" class="form-control" />
        </uib:tab>
        <uib:tab heading="{{'Students'|translate}}">
            <br/>
            <table class="lm-table lm-table-padded">
                <tr>
                    <th translate>Login</th>
                    <th translate>Name</th>
                    <th>Default</th>
                    <th>Global</th>
                    <th>Cloud</th>
                    <th translate>Mail</th>
                </tr>
                <tr>
                    <td translate>
                        Default
                    </td>
                    <td translate>
                        Student
                    </td>
                    <td>
                        <input type="number" ng:model="settings['role.student']['quota_default_global']" class="form-control" />
                    </td>
                    <td>
                        <input type="number" ng:model="settings['role.student']['quota_default_school']" class="form-control" />
                    </td>
                    <td>
                        <input type="number" ng:model="settings['role.student']['cloudquota_percentage']" class="form-control" />
                    </td>
                    <td>
                        <input type="number" ng:model="settings['role.student']['mailquota_default']" class="form-control" />
                    </td>
                </tr>
                <tr ng:repeat="(login,details) in non_default.student">
                    <td>
                        {{login}}
                    </td>
                    <td>
                        {{details.displayName}}
                    </td>
                    <td>
                        <input type="number" ng:model="details.QUOTA['linuxmuster-global'].VALUE" class="form-control" />
                    </td>
                    <td>
                        <input type="number" ng:model="details.QUOTA['default-school'].VALUE" class="form-control" />
                    </td>
                    <td>
                        <input type="number" ng:model="details.QUOTA.CQ.VALUE" class="form-control" />
                    </td>
                    <td>
                        <input type="number" ng:model="details.QUOTA.MQ.VALUE" class="form-control" />
                    </td>
                </tr>
<!--
                <tr ng:repeat="(login, quota) in quotas" ng:if="!isSpecialQuota(login) && !isDefaultQuota(login)">
                    <td>
                        {{login}}
                    </td>
                    <td>
                        {{quota.displayName}}
                    </td>
                    <td>
                        <input type="number" ng:model="quota.DEFLT" class="form-control" />
                    </td>
                    <td>
                        <input type="number" ng:model="quota.GLOBAL" class="form-control" />
                    </td>
                    <td>
                        <input type="number" ng:model="quota.CQ" class="form-control" />
                    </td>
                    <td>
                        <input type="number" ng:model="quota.MQ" class="form-control" />
                    </td>
                    <td>
                        <button class="btn btn-default" ng:click="remove(login)">
                            <i class="fa fa-trash-o"></i>
                        </button>
                    </td>
                </tr>
-->
            </table>
            <h4 translate>Add special quota</h4>
            <input type="text" placeholder="Add new" ng:model="_.addNewSpecial" typeahead-editable="false" typeahead-min-length="3" uib-typeahead="user[1].uid[0] as user[1].cn[0] for user in findUsers($viewValue) | limitTo:8" class="form-control" />
        </uib:tab>
        <uib:tab heading="{{'Classes'|translate}}">
            <br/>
            <table class="lm-table lm-table-padded">
                <tr>
                    <th translate>Name</th>
                    <th>Default</th>
                    <th translate>Mail</th>
                </tr>
                <tr ng:repeat="class in classes">
                    <td>
                        {{class.name}}
                    </td>
                    <td>
                        <input type="number" ng:model="class.quota" class="form-control" />
                    </td>
                    <td>
                        <input type="number" ng:model="class.mailquota" class="form-control" />
                    </td>
                </tr>
            </table>
        </uib:tab>
        <uib:tab heading="{{'Projects'|translate}}">
            <br/>
            <table class="lm-table lm-table-padded">
                <tr>
                    <th translate>Name</th>
                    <th>Default</th>
                    <th>Mail</th>
                </tr>
                <tr ng:repeat="project in projects">
                    <td>
                        {{project.name}}
                    </td>
                    <td>
                        <input type="number" ng:model="project.quota" class="form-control" />
                    </td>
                    <td>
                        <input type="number" ng:model="project.mailquota" class="form-control" />
                    </td>
                </tr>
            </table>
        </uib:tab>
        <uib:tab heading="{{'Special'|translate}}">
            <br/>
            <table class="lm-table lm-table-padded">
                <tr>
                    <th translate>Name</th>
                    <th>/home</th>
                    <th>/var</th>
                    <th translate>Mail</th>
                    <th></th>
                </tr>
                <tr ng:repeat="quota in specialQuotas">
                    <td>
                        {{quota.name}}
                    </td>
                    <td>
                        <input type="number" ng:model="quotas[quota.login].home" class="form-control" />
                    </td>
                    <td>
                        <input type="number" ng:model="quotas[quota.login].var" class="form-control" />
                    </td>
                    <td>
                        <input type="number" ng:model="quotas[quota.login].mail" class="form-control" />
                    </td>
                </tr>
            </table>
        </uib:tab>
    </uib:tabset>

    <div class="floating-toolbar-padder"></div>

    <floating-toolbar>
        <button ng:click="backups()" class="btn btn-default btn-flat pull-right"><i class="fa fa-history"></i></button>

        <button ng:click="save()" class="btn btn-default btn-flat" translate>Save</button>
        <button ng:click="saveApply()" class="btn btn-default btn-flat" translate>Save & apply</button>
    </floating-toolbar>
</div>
